<!DOCTYPE html>
<html>
  <head>
  	<title>Mojo Watch Face 1.0</title>
  </head>
  <body>
<h1>Mojo WatchFace 설정</h1>
<!--
    <select id='stateCombo' onchange='stateComboChange();'>
    </select>
 
    <select id='cityCombo' onchange='cityComboChange();'>
    </select>
 
     <select id='dongCombo' onchange='dongComboChange();'>
    </select>
 
<div id='tgt'></div>
<div id='weather'></div>
<script src="http://codesafe.github.io/script.js"></script>
-->

<p><input id="use24" required="required" type="checkbox" value="false" />&nbsp;24 시간제 사용</p>
<p><input id="useposition" required="required" type="checkbox" onclick="onUseposition(this)" />&nbsp;위치 기반 날씨 사용</p>
<p><input id="viberate" required="required" type="checkbox" />&nbsp;날씨 업데이트 시 진동</p>
<p>날씨 업데이트 주기</p>
<p>
	<select id='updatetime' style="width: 97px;">
	<option value="1">1시간</option>
	<option value="2">2시간</option>
	<option value="3">3시간</option>
	<option value="6">6시간</option>
	</select>
</p>
<p>&nbsp;</p>
<p>
	<input id="address" type="textbox" value="서울시 영등포구 문래동">
	<input id="addressbtn" type="button" value="경도/위도 계산" onclick="codeAddress()">
	<input id="lat" type="text" value="">
	<input id="lng" type="text" value="">
</p>
<p>
	<button id="save_button">저장</button>
</p>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>	
    <script>
    	// 주소로 lat, lng 구하기
    	  function codeAddress() {
		var geocoder = new google.maps.Geocoder();
		var address = document.getElementById("address").value;

		geocoder.geocode( { 'address': address}, function(results, status) {
		  if (status == google.maps.GeocoderStatus.OK) {

			//alert(results[0].geometry.location.lat());
			//alert(results[0].geometry.location.lng());
			document.getElementById("lat").value = results[0].geometry.location.lat();
			document.getElementById("lng").value = results[0].geometry.location.lng();

		  } 
		  else {
			alert("Geocode was not successful for the following reason: " + status);
		  }

		});
	  }
    
	function onUseposition(chkbox){
		if ( chkbox.checked == true ) {
			alert("use position");
			// hide select zone
			var add = document.getElementById("address");
			var addbtn = document.getElementById("addressbtn");
			var lat = document.getElementById("lat");
			var lng = document.getElementById("lng");
			add.style.visibility = "hidden";
			addbtn.style.visibility = "hidden";
			lat.style.visibility = "hidden";
			lng.style.visibility = "hidden";
		}
		else {
			alert("no use position");
			// show select zone
			var add = document.getElementById("address");
			var addbtn = document.getElementById("addressbtn");
			var lat = document.getElementById("lat");
			var lng = document.getElementById("lng");
			add.style.visibility = "hidden";	
			addbtn.style.visibility = "hidden";
			lat.style.visibility = "hidden";
			lng.style.visibility = "hidden";
		}
	}
    
      //Setup to allow easy adding more options later
      function saveOptions() {
        var ch_use24 = document.getElementById("use24");
        var ch_useposition = document.getElementById("useposition");
        var ch_viberate = document.getElementById("viberate");
        var sel_updatetime = document.getElementById("updatetime");
        var updatetime_value = sel_updatetime.options[sel_updatetime.selectedIndex].value;
        
        var options = {
        	"use24" : ch_use24.checked == true ? 1 : 0,
        	"useposition" : ch_useposition.checked == true ? 1 : 0,
        	"viberate" : ch_viberate.checked == true ? 1 : 0,
        	"updatetime" : Number(updatetime_value)
        }
        return options;
      };

      var submitButton = document.getElementById("save_button");
      submitButton.addEventListener("click", function() {
          var options = saveOptions();
          console.log("Save Config : " + JSON.stringify(options));
          var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(options));
          window.location.href = location;
        }, false);
    </script>	
</body>
</html>
